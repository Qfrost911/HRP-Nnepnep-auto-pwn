# 基于pwntools的有限特征fuzz和简单rop利用工具

做这个东西开始是为了当做软工作业的，但是写着写着发现挺有意思的，虽然后续想要再提高准确率和容纳更多特征，要整个项目

推倒重来，但是目前来看这个逻辑思想还是可以的，适用于常规AMD64 CTF PWN ，I386的我是没兴趣做了，太复杂的，汇编特征不稳定，凭我一个人的精力是没可能的。

# 原理

第一步 利用pwntools查找限定函数，查找到后赋值到变量。

下一步进行的就是fuzz比对，先判断程序编译的系统版本，分为18or16和20两大类型

然后用pwntools的search查询call指令的特征0XE8存在的地址把他们全部加入到数组，并且提取出此时call的相对地址

下一步，把限定函数的地址与数组里面的地址进行公式校验，得出fuzz地址 用这个地址和call的相对地址比对，比对成功就是证明此处call的是该限定函数，具体解释去看脚本内注释

下一步，检查该限定函数是否在危险函数定义分支里面，是的话则做出相对应的检测操作，返回相关数据到用户屏幕

最后，如果存在后门和溢出，再分别进行利用判断，满足条件给出建议性EXP（这里后续会扩展多种模板利用EXP）

### 环境需求

 运行需要依赖pwntools,numpy和python2

 pwntools https://github.com/Gallopsled/pwntools

pip install numpy

### 运行脚本命令

```
python2 fuzz.py binary_name
```

